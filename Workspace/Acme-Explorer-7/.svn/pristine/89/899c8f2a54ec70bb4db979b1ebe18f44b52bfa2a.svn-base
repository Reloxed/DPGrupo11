<%--
 * 
 *
 * Copyright (C) 2017 Universidad de Sevilla
 * 
 * The use of this project is hereby constrained to the conditions of the 
 * TDG Licence, a copy of which you may download from 
 * http://www.tdg-seville.info/License.html
 --%>


<%@page language="java" contentType="text/html; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1"%>

<%@taglib prefix="jstl" uri="http://java.sun.com/jsp/jstl/core"%>
<%@taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@taglib prefix="security"
	uri="http://www.springframework.org/security/tags"%>
<%@taglib prefix="display" uri="http://displaytag.sf.net"%>
<%@taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>

<h3> <jstl:out value="${trip.title}"> </jstl:out> </h3>

<table class="displayStyle">


<tr>
<th> <jstl:out value="${trip.title}"> </jstl:out>  </th>
<th>   </th>
</tr>

<tr>
<td> <strong> <spring:message code="trip.ticker" /> : </strong> </td>
<td> <jstl:out value="${trip.ticker}"> </jstl:out> </td>
</tr>

<tr>
<td> <strong> <spring:message code="trip.description" /> : </strong> </td>
<td> <jstl:out value="${trip.description}"> </jstl:out> </td>
</tr>

<tr>
<td> <strong> <spring:message code="trip.price" /> : </strong> </td>
<td> <jstl:out value="${trip.price}"> </jstl:out> </td>
</tr>

<tr>
<td> <strong> <spring:message code="trip.requirements" /> : </strong> </td>

<td>

<jstl:choose>
<jstl:when test="${not empty trip.requirements}">

<ul>
<jstl:forEach items="${trip.requirements}" var="requirement">

<li> <jstl:out value="${requirement}"> </jstl:out> </li>


</jstl:forEach>
</ul> 

</jstl:when>
<jstl:otherwise>

<spring:message code="trip.requirements.empty" />   

</jstl:otherwise>

</jstl:choose>
 </td>
</tr>

<security:authorize access="hasRole('MANAGER')">
<tr>
<td> <strong> <spring:message code="trip.publicationDate" /> : </strong> </td>
<td> <fmt:formatDate value="${trip.publicationDate}" pattern="dd/MM/yyyy" /> </td>
</tr>
</security:authorize>

<tr>
<td> <strong> <spring:message code="trip.startDate" /> : </strong> </td>
<td> <fmt:formatDate value="${trip.startDate}" pattern="dd/MM/yyyy" /> </td>
</tr>

<tr>
<td> <strong> <spring:message code="trip.endDate" /> : </strong> </td>
<td> <fmt:formatDate value="${trip.endDate}" pattern="dd/MM/yyyy" /> </td>
</tr>

<jstl:if test="${not empty trip.cancellationReason}">
<tr >
<td class="redCell"> <strong> <spring:message code="trip.isCancelled" /> </strong> </td>
<td > <jstl:out value="${trip.cancellationReason}"> </jstl:out> </td>
</tr>

</jstl:if>

<tr>
<td> <strong> <spring:message code="trip.stages" /> : </strong> </td>
<td> 

<jstl:set var="stages" value="${trip.stage}"  /> 
<spring:message code="trip.stage.number" var="stageNumber"/>
<spring:message code="trip.stage.title" var="stageTitle"/>
<spring:message code="trip.stage.description" var="stageDescription"/>
<spring:message code="trip.stage.price" var="stagePrice"/>

<display:table name="${stages}" id="child${parent_rowNum}" pagesize="15" class="displaytag">

<display:column property="number" title="${stageNumber}" sortable="false" />
<display:column property="title" title="${stageTitle}" sortable="false" />
<display:column property="description" title="${stageDescription}" sortable="false" />
<display:column property="price" title="${stagePrice}" sortable="false" />

</display:table>
 </td>
</tr>

<tr>
<td> <strong> <spring:message code="trip.category" /> : </strong> </td>
<td> <jstl:out value="${trip.category.name}"> </jstl:out> </td>
</tr>


<tr >
<td> <strong> <spring:message code="trip.tags" /> </strong> </td>
<td>

<jstl:choose>
<jstl:when test="${not empty trip.tags}">

<ul>
<jstl:forEach items="${trip.tags}" var="tag">

<li> <jstl:out value="${tag.name}"> </jstl:out> </li>


</jstl:forEach>
</ul> 

</jstl:when>
<jstl:otherwise>

<spring:message code="trip.tags.empty" />   

</jstl:otherwise>

</jstl:choose>
 </td>
</tr>


<tr>
<td> <strong> <spring:message code="trip.legaltext" /> : </strong> </td>
<td >

<div class="legalText">


<div> <jstl:out value="${trip.legaltext.title}"> </jstl:out> </div>
<br>

<div> <jstl:out value="${trip.legaltext.body}"> </jstl:out> </div>
<br>
<div> <fmt:formatDate value="${trip.legaltext.registerDate}" pattern="dd/MM/yyyy" />  </div>
<br>

<div>
<ul>
 <jstl:forEach items="${trip.legaltext.laws}" var="law">

<li> <jstl:out value="${law}"> </jstl:out> </li>


</jstl:forEach>
</ul>
 </div>

</div>
 
 </td>
</tr>

<security:authorize access="hasRole('MANAGER')">
<tr>
<td> <strong> <spring:message code="trip.vatTax" /> : </strong> </td>
<td> <jstl:out value="${trip.vatTax.percentage}"> </jstl:out> %  </td>
</tr>
</security:authorize>


<spring:message code="trip.ranger.display"  var="showRanger"/>

<tr>
<td> <strong> <spring:message code="trip.ranger" /> : </strong> </td>
<td> <jstl:out value="${trip.ranger.userAccount.username}">  &nbsp; (<a href="ranger/display.do?rangerId=${trip.ranger.id}"> ${showRanger} </a>) </jstl:out> </td>
</tr>





</table>


<jstl:if test="${not empty randomSponsorship}">
<jstl:set var="banner" value="${randomSponsorship.linkBanner}"/>
<jstl:set var="infoPage" value="${randomSponsorship.linkInfoPage}"/>

<a href="${infoPage}" target="_blank"> <img src="${banner}"> </a>
</jstl:if>

<div>


</div>



